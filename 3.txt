updated from master
updated from issue53
